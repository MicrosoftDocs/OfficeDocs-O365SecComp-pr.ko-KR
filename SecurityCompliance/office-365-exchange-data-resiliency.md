---
title: Office 365 Exchange 데이터 복구
ms.author: robmazz
author: robmazz
manager: laurawi
ms.date: 8/21/2018
audience: ITPro
ms.topic: article
ms.service: Office 365 Administration
localization_priority: None
search.appverid:
- MET150
ms.collection: Strat_O365_Enterprise
description: Exchange Online 및 Office 365 내에서 데이터 복구의 다양 한 측면에 대해 설명 합니다.
ms.openlocfilehash: 8d0448a95f010b766faf852a374513a1c2da61fa
ms.sourcegitcommit: 36c5466056cdef6ad2a8d9372f2bc009a30892bb
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 08/27/2018
ms.locfileid: "22533392"
---
# <a name="exchange-online-data-resiliency-in-office-365"></a><span data-ttu-id="564a7-103">Office 365의에서 Exchange Online 데이터 복구</span><span class="sxs-lookup"><span data-stu-id="564a7-103">Exchange Online Data Resiliency in Office 365</span></span>

## <a name="introduction"></a><span data-ttu-id="564a7-104">소개</span><span class="sxs-lookup"><span data-stu-id="564a7-104">Introduction</span></span>
<span data-ttu-id="564a7-p101">Exchange 데이터베이스에 영향을 줄 수 있는 손상에 두가지 유형이: (특정, 저장소 하드웨어)에 하드웨어 문제로 인해 발생 일반적으로, 물리적인 손상 부분이 및 기타 요인으로 인해 발생 하는 논리 손상 됩니다. 일반적으로, 두 유형의 Exchange 데이터베이스 내에서 발생할 수 있는 논리적 손상 가지</span><span class="sxs-lookup"><span data-stu-id="564a7-p101">There are two types of corruption that can affect an Exchange database: physical corruption, which is typically caused by hardware (in particular, storage hardware) problems, and logical corruption, which occurs due to other factors. Generally, there are two types of logical corruption that can occur within an Exchange database:</span></span> 
- <span data-ttu-id="564a7-p102">**논리적 손상 데이터베이스** -일치 하는 데이터베이스 페이지 체크섬 항목, 페이지에서 데이터를 제외한 잘못 되었습니다 논리적으로. 이 데이터베이스 엔진은 확장 가능한 저장소 엔진 (ESE ()) 데이터베이스 페이지를 작성 하려고 할 때 및 운영 체제는 성공 메시지를 반환 하는 경우에 발생할 수 있습니다, 데이터 하거나 하지 이나 작성 되었습니다 디스크에 잘못 된 위치에 작성 됩니다. *Flush 손실*라고 합니다. ESE에는 다양 한 기능 및 데이터베이스 및 기타 데이터 손실 시나리오의 물리적 손상을 방지 하기 위해 설계 된 보호 기능이 포함 됩니다. 손실 된 플러시 데이터 손실 되지 않도록 하려면 ESE 문제를 해결할 수 있는 기능 (단일 페이지 복원)와 함께 데이터베이스에 손실된 플러시 감지 메커니즘을 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p102">**Database logical corruption** - The database page checksum matches, but the data on the page is wrong logically. This can occur when the database engine (the Extensible Storage Engine (ESE)) attempts to write a database page and even though the operating system returns a success message, the data is either never written to the disk or it's written to the wrong place. This is referred to as a *lost flush*. ESE includes numerous features and safeguards that are designed to prevent physical corruption of a database and other data loss scenarios. To prevent lost flushes from losing data, ESE includes a lost flush detection mechanism in the database along with a feature (single page restore) to correct it.</span></span> 
- <span data-ttu-id="564a7-p103">**저장소 논리적 손상** -데이터 추가, 삭제 또는 사용자 하지 제공 되는 방식으로 조작 합니다. 이러한 경우는 일반적으로 타사 응용 프로그램에 의해 발생 합니다. 이것이 일반적으로 하는 사용자가 보기 손상으로 점에서 손상만입니다. Exchange 저장소의 논리적 손상 일련의 유효한 MAPI 작업 수를 생성 하는 트랜잭션을 고려 합니다. Exchange Online의 [원본 위치 유지](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) 기능 (못하도록 하기 때문 콘텐츠는 사용자 또는 응용 프로그램에 의해 영구적으로 삭제 되 고) 논리적 손상 저장소 로부터 보호를 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p103">**Store logical corruption** - Data is added, deleted, or manipulated in a way that the user doesn't expect. These cases are generally caused by third-party applications. It's generally only corruption in the sense that the user views it as corruption. The Exchange store considers the transaction that produced the logical corruption to be a series of valid MAPI operations. The [In-Place Hold](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) features in Exchange Online provides protection from store logical corruption (because it prevents content from being permanently deleted by a user or an application).</span></span> 

<span data-ttu-id="564a7-p104">Exchange Online 로그 검사와 로그를 재생 하는 동안 복제 된 로그 파일에 대 한 여러 일관성 검사를 수행합니다. 이러한 일관성 검사에는 시스템에 의해 복제 되 고에서 실제 손상을 방지 합니다. 예, 로그 검사 하는 동안 방법이 로그 파일을 확인 하 고 로그 파일에 기록 된 체크섬 메모리에 생성 된 체크섬과 일치 하는지의 유효성을 검사 하는 물리적 무결성 검사 합니다. 또한 로그 파일 헤더 로그 헤더에 기록 된 로그 파일 서명 로그 파일의과 일치 하는지 확인 하려면 봉투만 검사 합니다. 로그 재생 하는 동안 로그 파일 거치 추가로 대 한 조사 합니다. 예, 데이터베이스 헤더와 일치 하는지 확인 하려면 로그 파일의 서명을 사용 하 여 비교 하는 로그 서명도 포함 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p104">Exchange Online performs several consistency checks on replicated log files during both log inspection and log replay. These consistency checks prevent physical corruption from being replicated by the system. For example, during log inspection, there is a physical integrity check which verifies the log file and validates that the checksum recorded in the log file matches the checksum generated in memory. In addition, the log file header is examined to make sure the log file signature recorded in the log header matches that of the log file. During log replay, the log file undergoes further scrutiny. For example, the database header also contains the log signature which is compared with the log file's signature to ensure they match.</span></span> 

<span data-ttu-id="564a7-p105">Exchange Online에서 사서함 데이터 손상 방지 Exchange 네이티브 데이터 보호, 여러 서버와 함께 다른 여러 데이터 센터에서 응용 프로그램 수준 복제를 활용 하는 복구 전략을 사용 하 여 이루어집니다. 데이터 손상 또는 다른 이유로 인해 손실 되는 것을 보호할 수 있는 기능입니다. 이러한 기능에 의해 관리 되는 Microsoft 또는 Exchange Online 응용 프로그램 자체를 다음과 같이 네이티브 기능이 포함 됩니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p105">Protection against corruption of mailbox data in Exchange Online is achieved by using Exchange Native Data Protection, a resiliency strategy that leverages application-level replication across multiple servers and multiple datacenters along with other features that help protect data from being lost due to corruption or other reasons. These features include native features that are managed by Microsoft or the Exchange Online application itself, such as:</span></span>

- [<span data-ttu-id="564a7-125">데이터 사용 가능 그룹</span><span class="sxs-lookup"><span data-stu-id="564a7-125">Data Availability Groups</span></span>](https://docs.microsoft.com/exchange/back-up-email)
- <span data-ttu-id="564a7-126">단일 비트 교정</span><span class="sxs-lookup"><span data-stu-id="564a7-126">Single Bit Correction</span></span> 
- <span data-ttu-id="564a7-127">온라인 데이터베이스 검사</span><span class="sxs-lookup"><span data-stu-id="564a7-127">Online Database Scanning</span></span> 
- <span data-ttu-id="564a7-128">손실 된 플러시 감지</span><span class="sxs-lookup"><span data-stu-id="564a7-128">Lost Flush Detection</span></span> 
- <span data-ttu-id="564a7-129">단일 페이지 복원</span><span class="sxs-lookup"><span data-stu-id="564a7-129">Single Page Restore</span></span> 
- <span data-ttu-id="564a7-130">사서함 복제 서비스</span><span class="sxs-lookup"><span data-stu-id="564a7-130">Mailbox Replication Service</span></span> 
- <span data-ttu-id="564a7-131">로그 파일 검사</span><span class="sxs-lookup"><span data-stu-id="564a7-131">Log File Checks</span></span> 
- <span data-ttu-id="564a7-132">복원 파일 시스템에 배포</span><span class="sxs-lookup"><span data-stu-id="564a7-132">Deployment on Resilient File System</span></span> 

<span data-ttu-id="564a7-p106">위에 나열 된 기본 기능에 대 한 자세한 내용은 위의 하이퍼링크를 클릭 하 고 추가 정보에 대 한 및 하이퍼링크에 속하지 않은 항목에 대 한 자세한 내용은 아래를 참조 하십시오. 이러한 기본 기능 외에도 Exchange Online도 데이터 복구 기능이 포함와 같은 고객 관리할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p106">For more information on the native features listed above, click on the above hyperlinks, and see below for additional information and for details on items without hyperlinks. In addition to these native features, Exchange Online also includes data resiliency features that customers can manage, such as:</span></span> 
- [<span data-ttu-id="564a7-135">단일 항목 복구를 (기본적으로 사용 됨)</span><span class="sxs-lookup"><span data-stu-id="564a7-135">Single Item Recovery (enabled by default)</span></span>](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [<span data-ttu-id="564a7-136">원본 위치 유지 및 소송 보존</span><span class="sxs-lookup"><span data-stu-id="564a7-136">In-Place Hold and Litigation Hold</span></span>](https://docs.microsoft.com/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [<span data-ttu-id="564a7-137">삭제 된 항목 보존 및 Soft-Deleted 사서함 (모두 기본적으로 활성화)</span><span class="sxs-lookup"><span data-stu-id="564a7-137">Deleted Item Retention and Soft-Deleted Mailboxes (both enabled by default)</span></span>](https://docs.microsoft.com/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a><span data-ttu-id="564a7-138">데이터베이스 가용성 그룹</span><span class="sxs-lookup"><span data-stu-id="564a7-138">Database Availability Groups</span></span> 
<span data-ttu-id="564a7-p107">Office 365에서 모든 사서함 데이터베이스 [(DAG) 데이터베이스 가용성 그룹](https://docs.microsoft.com/exchange/back-up-email) 에서 호스팅되며 동일한 영역 내에서 지리적으로 별도 데이터 센터에 복제 합니다. 가장 일반적인 구성은 4 개의 데이터 센터;에 4 개의 데이터베이스 복사본 그러나 일부 지역에 더 적은 데이터 센터 (인도, 세 데이터 센터 및 오스트레일리아 및 일본에서 두 데이터 센터에 복제 데이터베이스). 하지만 모든 경우에서 모든 사서함 데이터베이스에는 함으로써 소프트웨어, 하드웨어 및 데이터 센터 오류도에서 사서함 데이터는 보호 되 고 있는지 확인 하는 여러 데이터 센터에 분산 된 4 개의 복사본입니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p107">Every mailbox database in Office 365 is hosted in a [database availability group (DAG)](https://docs.microsoft.com/exchange/back-up-email) and replicated to geographically-separate datacenters within the same region. The most common configuration is four database copies in four datacenters; however, some regions have fewer datacenters (databases are replicated to three datacenters in India, and two datacenters in Australia and Japan). But in all cases, every mailbox database has four copies that are distributed across multiple datacenters, thereby ensuring that mailbox data is protected from software, hardware, and even datacenter failures.</span></span> 

<span data-ttu-id="564a7-p108">이러한 4 개의 복사본에서 항상 사용 가능으로 구성 된 그룹에 세. 네번째 복사본 [지연 된 데이터베이스 복사본](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies)으로 구성 됩니다. 지연 된 데이터베이스 복사본 개별 사서함 복구 또는 사서함 항목 복구를 위한 되지는지 않습니다. 그 목적 시스템 전반, 치명적인 논리적 손상의 특수 한 이벤트에 대 한 복구 메커니즘을 제공 하는 것입니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p108">Out of these four copies, three of them are configured as highly available. The fourth copy is configured as a [lagged database copy](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies). The lagged database copy is not intended for individual mailbox recovery or mailbox item recovery. Its purpose is to provide a recovery mechanism for the rare event of system-wide, catastrophic logical corruption.</span></span> 

<span data-ttu-id="564a7-p109">Exchange Online에서 지연 된 데이터베이스 복사본은 7 일 로그 파일 재생 지연 시간으로 구성 됩니다. 또한 Exchange 재생 지연 관리자는 자체를 복구 하 고 로그 파일 증가 관리 하는 지연 된 데이터베이스 복사본 수 있도록 지연 된 복사본에 대 한 아래로 동적 로그 파일 재생을 제공 하려면 활성화 됩니다. 지연 된 복사본 Exchange Online에 사용 하는 데이터베이스, 이지만 보장 된 시점에서 백업을 아니라는 것을 이해 하는 것이 중요 합니다. Exchange Online에서 지연 된 데이터베이스 복사본은 가용성 임계값이 설정, 일반적으로 약 90%, 여기에서 지연 된 복사본을 포함 하는 디스크는 디스크 오류와는 매우 사용 되 고 지연 된 복사본으로 인해 손실 기간으로 인해도 (으로 인해 자동 재생 아래로), 복사 여기서는 지연 된 데이터베이스 복사본 다시 작성 하는 로그 기간으로 큐를 재생 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p109">Lagged database copies in Exchange Online are configured with a seven-day log file replay lag time. In addition, the Exchange Replay Lag Manager is enabled to provide dynamic log file play down for lagged copies to allow lagged database copies to self-repair and manage log file growth. Although lagged database copies are used in Exchange Online, it is important to understand that they are not a guaranteed point-in-time backup. Lagged database copies in Exchange Online have an availability threshold, typically around 90%, due to periods where the disk containing a lagged copy is lost due to disk failure, the lagged copy becoming a highly-available copy (due to automatic play down), as well as the periods where the lagged database copy is re-building the log replay queue.</span></span> 

## <a name="transport-resilience"></a><span data-ttu-id="564a7-150">전송 복원 력</span><span class="sxs-lookup"><span data-stu-id="564a7-150">Transport Resilience</span></span> 
<span data-ttu-id="564a7-p110">Exchange Online 두 기본 전송 복구 기능이 포함: 섀도 중복성 및 보안 네트워크입니다. 섀도 중복 전송 되는 동안 메시지의 중복 복사본을 유지 합니다. 메시지를 배달 후 메시지의 중복 복사본을 유지 하는 보안 네트워크입니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p110">Exchange Online includes two primary transport resilience features: Shadow Redundancy and Safety Net. Shadow Redundancy keeps a redundant copy of a message while it is in transit. Safety Net keeps a redundant copy of a message after the message is successfully delivered.</span></span> 

<span data-ttu-id="564a7-p111">섀도 중복 된 각 Exchange Online 전송 서버는 성공적으로 보내는 서버에 메시지를 받는 것을 승인 하기 전에 받은 각 메시지의 복사본을 만듭니다. 그러면 모든 메시지 전송 파이프라인에 전송 중에 중복 됩니다. Exchange Online 원본 메시지 전송 중에서 손실 된 결정을 하는 경우 메시지의 중복 복사본을 다시 배달 됩니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p111">With Shadow Redundancy, each Exchange Online transport server makes a copy of each messages it receives before it acknowledges successfully receiving the message to the sending server. This makes all messages in the transport pipeline redundant while in transit. If Exchange Online determines the original message was lost in transit, a redundant copy of the message is redelivered.</span></span> 

<span data-ttu-id="564a7-p112">보안 네트워크는 사서함 서버의 전송 서비스와 연결 된 전송 큐입니다. 이 큐는 서버에서 성공적으로 처리 된 메시지의 복사본을 저장 합니다. 사서함 데이터베이스 또는 서버 오류는 오래 된 복사본에는 사서함 데이터베이스의 정품 인증 필요로 하는 경우 보안 네트워크 큐의 메시지 사서함 데이터베이스의 새 활성 복사본을 자동으로 다시 전송 됩니다. 보안 네트워크 중복, 이기도 한 단일 오류 지점으로 전송 하지 않도록 합니다. 사용 하 여 기본 보안 네트워크 및 그림자 보안 네트워크의 개념은 하는데 12 시간 이상에 대 한 기본 보안 네트워크를 사용할 수 없는 경우, 요청 될 그림자 다시 전송 요청 및 메시지는 다시 배달 그림자 보안 네트워크에서 다시 전송 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p112">Safety Net is a transport queue that is associated with the Transport service on a Mailbox server. This queue stores copies of messages that were successfully processed by the server. When a mailbox database or server failure requires activating an out-of-date copy of the mailbox database, messages in the Safety Net queue are automatically resubmitted to the new active copy of the mailbox database. Safety Net is also redundant, thereby eliminating transport as a single point of failure. It uses the concept of a Primary Safety Net and a Shadow Safety Net wherein if the Primary Safety Net is unavailable for more than 12 hours, resubmit requests become shadow resubmit requests, and messages are re-delivered from the Shadow Safety Net.</span></span>

<span data-ttu-id="564a7-p113">보안 네트워크에서 메시지 이루어졌기 Dag와 사서함을 관리 하는 Microsoft Exchange Replication service의 활성 관리자 구성 요소에 의해 자동으로 시작 된 데이터베이스 복사본입니다. 보안 네트워크에서 메시지 다시 전송 하려면 없음 수동 작업이 필요 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p113">Message resubmissions from Safety Net are automatically initiated by the Active Manager component of the Microsoft Exchange Replication service that manages DAGs and mailbox database copies. No manual actions are required to resubmit messages from Safety Net.</span></span> 

## <a name="single-bit-correction"></a><span data-ttu-id="564a7-164">단일 비트 교정</span><span class="sxs-lookup"><span data-stu-id="564a7-164">Single Bit Correction</span></span> 
<span data-ttu-id="564a7-p114">ESE는 하드웨어 오류가 발생 하는 단일 비트 CRC 오류 (명시적 단일 비트 대칭 이동)를 감지 하는 메커니즘을 포함 합니다 (및 물리적인 손상 부분이 나타내는 이와 같이). 이러한 오류는 발생 ESE 자동으로 해당 수정 하 고 이벤트 로그에 이벤트를 기록 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p114">ESE includes a mechanism to detect and resolve single-bit CRC errors (aka single-bit flips) that are the result of hardware errors (and as such they represent physical corruption). When these errors occur, ESE automatically corrects them and logs an event in the event log.</span></span> 

## <a name="online-database-scanning"></a><span data-ttu-id="564a7-167">온라인 데이터베이스 검사</span><span class="sxs-lookup"><span data-stu-id="564a7-167">Online Database Scanning</span></span> 
<span data-ttu-id="564a7-p115">(로 알려져 *데이터베이스 checksumming*)를 검색 하는 온라인 데이터베이스는 여기서는 ESE를 사용 하 여 데이터베이스 일관성 검사 각 페이지를 읽고 확인 페이지 손상에 대 한 프로세스입니다. 주요 목적은 물리적 손상 되 고 인식 되지 않거나 시작 트랜잭션 작업에 의해 있는 손실된 플러시를 검색 하는 것입니다. 사후 저장소 크래시 작업을 수행도 데이터베이스를 검색 합니다. 공간 작동 중단,으로 인해 누수 될 수 및 온라인 데이터베이스 검사를 찾아서 손실된 공간을 복구 합니다. 시스템은 모든 데이터베이스 7 일 마다을 검색 하 고 완벽 하 게 기대 설계 되었습니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p115">Online database scanning (also known as *database checksumming*) is the process where an ESE uses a database consistency checker to read each page and check for page corruption. The primary purpose is to detect physical corruption and lost flushes that may not be getting detected by transactional operations. Database scanning also performs post-store crash operations. Space can be leaked due to crashes, and online database scanning finds and recovers lost space. The system is designed with the expectation that every database is fully scanned once every seven days.</span></span> 

## <a name="lost-flush-detection"></a><span data-ttu-id="564a7-173">손실 된 플러시 감지</span><span class="sxs-lookup"><span data-stu-id="564a7-173">Lost Flush Detection</span></span> 
<span data-ttu-id="564a7-p116">손실 된 플러시 발생 디스크 하위 시스템/운영 체제에 완료 된 것으로 반환 되는 데이터베이스 쓰기 작업을 실제로 작성 되지 않은 경우, 디스크 또는 잘못 된 위치에 작성 되었습니다. 플러시 사고 손실 수 ESE 손실 된 데이터의 결과로 만들어진에서 손실된 플러시를 방지 하기 위해 되므로 데이터베이스 논리 손상의 결과 포함 손실된 플러시 감지 메커니즘 합니다. 데이터베이스 페이지는 수동 복사본에 작성 된 대로 활성 복사본에서 손실 된 플러시에 대 한 검사를 수행 됩니다. 손실 된 플러시 발견 되 면 ESE 프로세스에 패치를 적용 하는 페이지를 사용 하는 프로세스를 복구할 수 있습니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p116">A lost flush occurs when a database write operation that the disk subsystem/operating system returned as completed did not actually get written to disk, or was written in the wrong location. Lost flush incidents can result in database logical corruption, so to prevent lost flushes from resulting in lost data, ESE includes a lost flush detection mechanism. As database pages are written to passive copies, a check is performed for lost flushes on the active copy. If a lost flush is detected, ESE can repair the process using a page patching process.</span></span> 

## <a name="single-page-restore"></a><span data-ttu-id="564a7-178">단일 페이지 복원</span><span class="sxs-lookup"><span data-stu-id="564a7-178">Single Page Restore</span></span> 
<span data-ttu-id="564a7-p117">명시적 *페이지에 패치를 적용*하는 단일 페이지 복원은 손상 된 데이터베이스 페이지 정상 복제 데이터베이스에서 정상 상태의 복사본으로 바뀌는 자동 프로세스입니다. 손상 된 페이지에 대 한 복구 프로세스는 활성 또는 수동 데이터베이스 복사본 인지에 따라 달라 집니다. 페이지 복사 하는 것이 페이지는 완전히 최신 제공 활성 데이터베이스 복사본에서 손상 된 페이지를 발견 하는 경우 해당 복제 데이터베이스 중 하나에서 복사할 수 것입니다. 이 작업은 로그 스트림으로 사서함 데이터베이스 복제의 기준이 되는 페이지에 대 한 요청을 배치 하 여 수행 됩니다. 복제 데이터베이스에서 페이지를 요청 하는 즉시 요청 하는 데이터베이스 복사본으로 페이지의 복사본을 발송 하 여 응답 합니다. 또한 단일 페이지 복원 복제본은 현재 오프 라인 하는 경우에 active 복제 데이터베이스에서 페이지를 요청 하는 비동기 통신 메커니즘을 제공 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p117">Single page restore, aka *page patching*, is an automatic process where corrupt database pages are replaced by healthy copies from a healthy replica. The repair process for a corrupt page depends on whether the database copy is active or passive. When an active database copy encounters a corrupted page, it can copy a page from one of its replicas, provided the page it copies is completely up-to-date. This is accomplished by putting a request for the page into the log stream, which is the basis of mailbox database replication. As soon as a replica encounters the page request it responds by sending a copy of the page to the requesting database copy. Single page restore also provides an asynchronous communication mechanism for the active to request a page from replicas, even if the replicas are currently offline.</span></span> 

<span data-ttu-id="564a7-p118">수동 데이터베이스 복사본에서 손상 된 경우 지연 된 데이터베이스 복사본을 포함 하 여 이러한 복사본의 활성 복사본 뒤에 항상 되므로, 것은 항상 안전 수동 복사본에 활성 복사본의 모든 페이지를 복사할 수 있습니다. 수동 데이터베이스 복사본이 이므로 특성 항상 사용 가능 하 여 페이지의 프로세스에 패치를 적용 하는 동안 로그 재생은 일시 중단, 하지만 로그 복사를 계속 실행 합니다. 수동 데이터베이스 복사본이 활성 복사본에서 손상된 된 페이지의 복사본을 검색, 최대 필요한 로그 생성 요구 사항을 만족 하는 로그 파일 복사 하 고 검사, 하 고 손상 된 페이지를 패치 때까지 기다립니다. 페이지 패치 된 후 로그 재생을 다시 시작 합니다. 지연 된 데이터베이스는 먼저 patchable 상태를 달성 하기 위해 필요한 모든 로그 파일을 재생 한다는 점을 제외 하면 하는 프로세스는 지연 된 데이터베이스 복사본에 대 한 동일 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p118">In case of corruption in a passive database copy, including a lagged database copy, because these copies are always behind their active copy, it is always safe to copy any page from the active copy to a passive copy. A passive database copy is by nature highly available, so during the page patching process, log replaying is suspended, but log copying continues. The passive database copy retrieves a copy of the corrupted page from the active copy, waits until the log file which meets the maximum required log generation requirement is copied and inspected, and then patches the corrupt page. Once the page has been patched, log replay resumes. The process is the same for the lagged database copy, except that the lagged database first replays all log files that are necessary to achieve a patchable state.</span></span> 

## <a name="mailbox-replication-service"></a><span data-ttu-id="564a7-190">사서함 복제 서비스</span><span class="sxs-lookup"><span data-stu-id="564a7-190">Mailbox Replication Service</span></span> 
<span data-ttu-id="564a7-p119">사서함 이동은 대규모 전자 메일 서비스 관리의 핵심 부분입니다. 항상 업데이트 된 기술 및 제한 된 저희 엔지니어는 사서함을 유지 하는 동안이 작업을 수행 하기 위해 수행할 수 있게 하는 강력한 필요 하므로 다루는에 대 한 하드웨어 및 버전 업그레이드도 이동 하는 투명 하 게 사용자에 게 (온라인 계속 해 서 확인 프로세스) 전반에 걸쳐 키 하 고 확인 하는 프로세스 확장성이 향상 되어 정상적으로 사서함을 더 큰 가져오고 더 큰 됩니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p119">Moving mailboxes is a key part of managing a large-scale email service. There are always updated technologies and hardware and version upgrades to deal with, so having a robust, throttled system that enables our engineers to accomplish this work while keeping the mailbox moves transparent to users (by making sure they stay online throughout the process) is key and making sure that the process scales up gracefully as mailboxes get larger and larger.</span></span> 

<span data-ttu-id="564a7-p120">Exchange 사서함 복제 서비스 (MRS)는 데이터베이스 간에 사서함을 이동 하는 일을 담당 합니다. 이동 하는 동안 MRS 사서함 내의 모든 항목에 대해 일관성 확인을 수행합니다. 일관성 문제가 발견 되는 경우 MRS는 문제를 해결 또는 사서함에서 손상을 제거 함으로써 손상 된 항목을 건너뜁니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p120">The Exchange Mailbox Replication Service (MRS) is responsible for moving mailboxes between databases. During the move, MRS performs a consistency check on all items within the mailbox. If a consistency issue is found, MRS will either correct the problem, or skip the corrupted items, thereby removing the corruption from the mailbox.</span></span> 

<span data-ttu-id="564a7-p121">MRS Exchange Online의 구성 요소 이기 때문에 변경할 수 해당 코드에서 주소 새로운 형태의 손상 나중에 검색 되는. 예, MRS를 수정할 수 없는 일관성 문제를 감지는 하는 경우는 수 분석 손상, MRS 코드를 변경 하 고 일관성 오류를 수정 (것을 이해 하는 경우 하는 방법).</span><span class="sxs-lookup"><span data-stu-id="564a7-p121">Because MRS is a component of Exchange Online, we can make changes in its code to address new forms of corruption that are detected in the future. For example, if we detect a consistency issue that MRS is not able to fix, we can analyze the corruption, change the MRS code and correct the inconsistency (if we understand how to).</span></span> 

## <a name="log-file-checks"></a><span data-ttu-id="564a7-198">로그 파일 검사</span><span class="sxs-lookup"><span data-stu-id="564a7-198">Log File Checks</span></span> 
<span data-ttu-id="564a7-p122">Exchange 데이터베이스에서 생성 된 모든 트랜잭션 로그 파일 여러 형태의 일관성 검사를 거쳐야 합니다. 로그 파일을 만들 때 먼저 완료 이며 비트 패턴 작성 된 일련의 로그 쓰기를 수행 합니다. 이 통해 Exchange Online 일련의 (손실 된 플러시, CRC 및 기타 검사) 작성 된 것 처럼 각 로그 파일의 유효성을 검사 하려면 검사를 실행 하 고 복제 되는 다시 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p122">All transaction log files generated by an Exchange database undergo several forms of consistency checks. When a log file is created, the first thing done is a bit pattern is written and then a series of log writes is performed. This enables Exchange Online to execute a series of checks (lost flush, CRC and other checks) to validate each log file as it is written, and again as it is replicated.</span></span> 

## <a name="deployment-on-resilient-file-system"></a><span data-ttu-id="564a7-202">복원 파일 시스템에 배포</span><span class="sxs-lookup"><span data-stu-id="564a7-202">Deployment on Resilient File System</span></span> 
<span data-ttu-id="564a7-p123">파일 시스템 수준에서 발생 하는 손상을 방지 하기 위해 Exchange Online 배포 되 향상 된 복구 기능을 제공 하도록 복원 파일 시스템 (ReFS) 파티션에서 합니다. ReFS는 함으로써 데이터 가용성 및 무결성을 최대화 하는 데이터 손상에 대해 더욱 유연 하 게 하도록 설계 된 파일 시스템 Windows Server 2012 및 그 이후 버전입니다. ReFS 향상 된 기능을 제공 하는 특히 방식으로 메타 데이터를 새로 고쳐집니다 데이터에 대 한 더 나은 보호 기능을 제공 하 고 데이터 손상의 경우를 줄일 수는 있습니다. 파일 데이터의 무결성을 확인 한 체크섬을 사용 하 고 해당 데이터 손상을 수 있는지 확인 하는 메타 데이터를 쉽게 발견 하 고 복구 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p123">To help prevent corruption from occurring at the file system level, Exchange Online is being deployed on Resilient File System (ReFS) partitions to provide improved recovery capabilities. ReFS is a file system in Windows Server 2012 and later that is designed to be more resilient against data corruption thereby maximizing data availability and integrity. Specifically, ReFS brings improvements in the way that metadata is updated which offers better protection for data and reduces data corruption cases. It also uses checksums to verify the integrity of file data and metadata ensuring that data corruption is easily found and repaired.</span></span> 

<span data-ttu-id="564a7-207">Exchange Online 가지 여러 ReFS 이점 활용 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-207">Exchange Online takes advantage of several ReFS benefits:</span></span> 
- <span data-ttu-id="564a7-p124">데이터 무결성에 더 많은 복구 데이터 손상 문제 감소를 의미합니다. 손상 문제 발생 횟수를 줄이면 적은 불필요 하 게 데이터베이스 reseeds 의미 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p124">More resiliency in data integrity means fewer data corruption incidents. Reducing the number of corruption incidents means fewer unnecessary database reseeds.</span></span> 
- <span data-ttu-id="564a7-210">빨리와 보다 명확 하 게 손상 사례의 감지를 사용 하도록 설정, 고객 데이터를 수정 하도록 허용 하는 메타 데이터에서 실행 되는 체크섬 데이터 볼륨에 회색 오류가 발생 하기 전에 손상 됩니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-210">Checksum running on metadata enabling detections of corruption cases sooner and more deterministically, allowing us to fix customer data corruption before grey failures occur on data volumes.</span></span>
- <span data-ttu-id="564a7-211">매우 큰 데이터 집합에서 잘 작동 하도록 설계-페타바이트 더 큰 및-없이 성능에 미치는 영향</span><span class="sxs-lookup"><span data-stu-id="564a7-211">Designed to work well with extremely large data sets—petabytes and larger—without performance impact</span></span>
- <span data-ttu-id="564a7-212">Exchange Online에서 사용 하 여 BitLocker 암호화와 같은 다른 기능에 대 한 지원 합니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-212">Support for other features used by Exchange Online, such as BitLocker encryption.</span></span> 

<span data-ttu-id="564a7-213">Exchange Online에서 다른 ReFS 기능 혜택도:</span><span class="sxs-lookup"><span data-stu-id="564a7-213">Exchange Online also benefits from other ReFS features:</span></span> 
- <span data-ttu-id="564a7-p125">**무결성 (무결성 스트림)** -ReFS 다양 한 데이터 손실이 발생할 정상적으로 수 있는 일반적인 오류 로부터 보호 하는 방식으로 데이터를 저장 합니다. Office 365 검색 가능한 가장 빠른 디스크 손상 검색 및 파일 콘텐츠의 체크섬을 위해 무결성 스트림을 사용 합니다. 또한 기능 (쓰기 작업이 완료 되지 않으면 정전 등으로 인해.) 하는 경우 "찢은 기록"으로 인해 손상 문제를 줄입니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p125">**Integrity (Integrity Streams)** - ReFS stores data in a way that protects it from many of the common errors that can normally cause data loss. Office 365 Search uses Integrity Streams to help with early disk corruption detection and checksums of file content. The feature also reduces corruption incidents caused by “Torn Writes” (when a write operation does not complete due to power outages, etc.).</span></span> 
- <span data-ttu-id="564a7-p126">**가용성 (Salvage)** -ReFS 데이터의 가용성 우선 순위를 지정 합니다. 파일 시스템 볼 수 있었습니다 종종 시스템 복구에 대 한 오프 라인을 악용 하는 데이터 손상에 취약 합니다. 손상이 발생 하는 경우에 드물긴 하지만 ReFS 구현 구제, 라이브 볼륨에 네임 스페이스에서 손상 된 데이터를 제거 하 고 적절 한 데이터는 부정적인 영향을 받지 않도록 수리 가능한 비 손상 된 데이터를 보장 하는 기능입니다. Salvage 기능을 적용 하 고 Exchange Online 데이터베이스 볼륨에 데이터 손상을 격리는 막을 수만 영향을 받지 데이터베이스 손상 된 볼륨에 손상 및 복구 작업의 시간 사이의 정상 것을 의미 합니다. 이 등의 디스크 손상 문제 영향을 받을 수는 일반적으로 데이터베이스의 가용성이 높아집니다.</span><span class="sxs-lookup"><span data-stu-id="564a7-p126">**Availability (Salvage)** - ReFS prioritizes the availability of data. Historically, file systems were often susceptible to data corruption that would require the system to be taken offline for repair. Although rare, if corruption does occur, ReFS implements salvage, a feature that removes the corrupt data from the namespace on a live volume and ensures that good data is not adversely affected by non-repairable corrupt data. Applying the Salvage feature and isolating data corruption to Exchange Online database volumes means that we can keep non-affected databases on a corrupted volume healthy between the time of corruption and repair action. This increases the availability of databases that would normally be affected by such disk corruption issues.</span></span> 