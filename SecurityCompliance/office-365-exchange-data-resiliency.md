---
title: Office 365 Exchange 데이터 복구
ms.author: robmazz
author: robmazz
manager: laurawi
audience: ITPro
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
search.appverid:
- MET150
ms.collection:
- Strat_O365_IP
- M365-security-compliance
description: Exchange Online 및 Office 365 내의 다양 한 데이터 복구 측면에 대 한 설명입니다.
ms.openlocfilehash: 96611c2db166e34a47b845b5683a367dd29ec25f
ms.sourcegitcommit: f0d23e57b00f07cef5b1b2d366eaeeeacda37e3e
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 07/18/2019
ms.locfileid: "35786673"
---
# <a name="exchange-online-data-resiliency-in-office-365"></a>Office 365의 Exchange Online 데이터 복구

## <a name="introduction"></a>소개
Exchange 데이터베이스에 영향을 줄 수 있는 두 가지 유형의 손상은 일반적으로 하드웨어 (특히 저장 하드웨어) 문제가 발생 하 여 발생 하는 물리적 손상 및 기타 요인으로 인 한 논리적 손상입니다. 일반적으로 Exchange 데이터베이스 내에서 발생할 수 있는 논리적 손상에는 다음과 같은 두 가지 유형이 있습니다. 
- **데이터베이스 논리적 손상** -데이터베이스 페이지 체크섬은 일치 하지만 페이지의 데이터가 논리적으로 잘못 되었습니다. 데이터베이스 엔진 (ESE (Extensible Storage Engine))에서 데이터베이스 페이지를 쓰려고 했지만 운영 체제가 성공 메시지를 반환 하는 경우에는 데이터가 디스크에 기록 되지 않거나 잘못 된 위치에 기록 된 경우에 발생할 수 있습니다. 이를 *손실 플러시*라고 합니다. ESE에는 데이터베이스 및 기타 데이터 손실 시나리오의 물리적인 손상을 방지 하기 위해 설계 된 다양 한 기능 및 보호책이 포함 되어 있습니다. 데이터 손실 로부터 손실 플러시가 발생 하지 않도록 하기 위해 ESE에는 데이터베이스의 손실 플러시 감지 메커니즘 (단일 페이지 복원)이 포함 되어 있습니다. 
- **저장소 논리적 손상** -사용자가 기대 하지 않는 방식으로 데이터를 추가, 삭제 또는 조작 합니다. 이러한 경우는 일반적으로 타사 응용 프로그램에 의해 발생 합니다. 일반적으로 사용자가 해당 개체를 손상으로 보기 때문에 손상이 발생 합니다. Exchange 저장소는 논리적 손상을 생성 한 트랜잭션이 유효한 MAPI 작업의 계열로 간주 합니다. Exchange Online의 원본 [위치 유지](https://docs.microsoft.com/exchange/security-and-compliance/create-or-remove-in-place-holds) 기능은 사용자 또는 응용 프로그램에 의해 콘텐츠가 영구적으로 삭제 되는 것을 방지 하므로 저장소 논리적 손상의 보호 기능을 제공 합니다. 

Exchange Online은 로그 검사 및 로그 재생 중에 복제 된 로그 파일에서 여러 가지 일관성 확인을 수행 합니다. 이러한 일관성 검사를 통해 물리적 손상은 시스템에 의해 복제 되지 않습니다. 예를 들어 로그 검사 중에는 로그 파일을 확인 하 고 로그 파일에 기록 된 체크섬이 메모리에 생성 된 체크섬과 일치 하는지 확인 하는 물리적 무결성 검사를 수행 합니다. 또한 로그 헤더에 기록 된 로그 파일 서명이 로그 파일의 서명과 일치 하는지 확인 하기 위해 log file 헤더를 검사 합니다. 로그를 재생 하는 동안 로그 파일에서 더 정밀 조사를 수행 합니다. 예를 들어 데이터베이스 헤더에는 로그 파일의 서명과 비교 하 여 일치 여부를 확인 하는 로그 시그너처도 포함 됩니다. 

Exchange Online에서 사서함 데이터가 손상 되지 않도록 보호 기능을 사용 하는 경우 Exchange Native Data Protection, 여러 서버에서 응용 프로그램 수준 복제를 활용 하는 복구 전략 및 다른 기능과 함께 여러 데이터 센터 손상 또는 다른 이유로 인해 데이터가 손실 되는 것을 방지 하는 기능 이러한 기능에는 다음과 같은 Microsoft 또는 Exchange Online 응용 프로그램 자체에서 관리 되는 기본 기능이 포함 되어 있습니다.

- [데이터 가용성 그룹](https://docs.microsoft.com/exchange/back-up-email)
- 단일 비트 교정 
- 온라인 데이터베이스 검색 
- 손실 된 플러시 감지 
- 단일 페이지 복원 
- 사서함 복제 서비스 
- 로그 파일 검사 
- 회복성 있는 파일 시스템에 대 한 배포 

위에 나열 된 기본 기능에 대 한 자세한 내용은 위의 하이퍼링크를 클릭 하 고 자세한 내용과 하이퍼링크 없이 항목에 대 한 세부 정보를 보려면 아래를 참조 하십시오. Exchange Online에는 이러한 기본 기능 외에도 고객이 관리할 수 있는 데이터 복구 기능도 포함 되어 있습니다. 
- [단일 항목 복구 (기본적으로 사용 가능)](https://docs.microsoft.com/exchange/recipients-in-exchange-online/manage-user-mailboxes/recover-deleted-messages) 
- [원본 위치 유지 및 소송 보존](https://docs.microsoft.com/exchange/security-and-compliance/in-place-and-litigation-holds) 
- [삭제 된 항목 보존 및 일시 삭제 된 사서함 (기본적으로 사용 하도록 설정 됨)](https://docs.microsoft.com/exchange/recipients-in-exchange-online/delete-or-restore-mailboxes) 

## <a name="database-availability-groups"></a>데이터베이스 사용 가능 그룹 
Office 365의 모든 사서함 데이터베이스는 [DAG (데이터베이스 사용 가능 그룹)](https://docs.microsoft.com/exchange/back-up-email) 에 호스트 되 고 동일한 지역 내의 지리적으로 구분 된 데이터 센터로 복제 됩니다. 가장 일반적인 구성은 4 개의 데이터 센터에 있는 네 개의 데이터베이스 복사본입니다. 그러나 일부 지역에는 데이터 센터가 더 적고, 데이터베이스는 인도로 세 데이터 센터에 복제 되며, 오스트레일리아와 일본에는 두 데이터 센터가 있습니다. 그러나 모든 경우에는 모든 사서함 데이터베이스에 여러 데이터 센터에 분산 된 복사본이 4 개 있으므로 사서함 데이터를 소프트웨어, 하드웨어 및 데이터 센터 오류 로부터 보호할 수 있습니다. 

이 네 개의 복사본 중에서 세 개 복사본이 사용 가능한 고가용성으로 구성 됩니다. 네 번째 복사본은 [지연 된 데이터베이스 복사본](https://docs.microsoft.com/Exchange/high-availability/manage-ha/activate-lagged-db-copies)으로 구성 됩니다. 지연 된 데이터베이스 복사본은 개별 사서함 복구 또는 사서함 항목 복구를 위한 것이 아닙니다. 이는 시스템 전반의 치명적 논리적 손상의 드문 이벤트에 대 한 복구 메커니즘을 제공 하는 데 목적이 있습니다. 

Exchange Online의 지연 된 데이터베이스 복사본은 7 일 동안의 로그 파일 재생 지연 시간을 사용 하 여 구성 됩니다. 또한 Exchange 재생 지연 관리자는 지연 된 복사본에 대해 동적 로그 파일 재생을 제공 하 여 지연 된 데이터베이스 복사본의 자동 복구 및 관리 로그 파일 증가를 관리할 수 있도록 합니다. 지연 된 데이터베이스 복사본은 Exchange Online에서 사용 되지만 보장 되는 지정 시간 백업이 아니라는 점을 이해 하는 것이 중요 합니다. Exchange Online의 지연 된 데이터베이스 복사본은 디스크 오류로 인해 지연 된 복사본을 포함 하는 디스크가 손실 되는 마침표로 인해 일반적으로 90% 인 가용성 임계값을 가지 며, 자동 재생으로 인 한 지연 된 복사본은 고가용성 복사본으로 사용 됩니다. 지연 된 데이터베이스 복사본에서 로그 재생 큐를 다시 작성 하는 기간 

## <a name="transport-resilience"></a>전송 복구 
Exchange Online에는 섀도 중복성 및 보안 네트워크 라는 두 가지 기본 전송 복구 기능이 포함 되어 있습니다. 섀도 중복성은 메시지가 전송 되는 동안 메시지의 중복 복사본을 보관 합니다. 보안 네트워크는 메시지가 배달 된 후 메시지의 중복 복사본을 보관 합니다. 

섀도 중복성을 사용 하는 경우 각 Exchange Online 전송 서버는 보내는 서버에 대 한 메시지 수신을 올바르게 확인 하기 전에 받는 각 메시지의 복사본을 만듭니다. 이를 통해 전송 파이프라인의 모든 메시지를 전송할 때 중복 됩니다. Exchange Online에서 원본 메시지가 전송 중 손실 되었음을 확인 하면 메시지의 중복 복사본을 것 판단 됩니다. 

보안 네트워크는 사서함 서버의 전송 서비스와 연결 된 전송 큐입니다. 이 큐는 서버에 의해 성공적으로 처리된 메시지의 복사본을 저장합니다. 사서함 데이터베이스 또는 서버 오류에 대해 오래 된 사서함 데이터베이스 복사본을 활성화 해야 하는 경우 보안 네트워크 큐의 메시지가 사서함 데이터베이스의 새 활성 복사본으로 자동 다시 전송 됩니다. 보안 네트워크도 중복 되므로 단일 실패 지점으로 전송 되지 않습니다. 기본 보안 네트워크는 12 시간 이상 사용할 수 없는 경우 기본 보안 네트워크와 섀도 보안 네트워크의 개념을 사용 하며, 전송 요청은 섀도 다시 전송 요청이 되 고, 메시지는 섀도 보안 네트워크에서 다시 배달 됩니다.

보안 네트워크에서 상황이 메시지는 Dag 및 사서함 데이터베이스 복사본을 관리 하는 Microsoft Exchange 복제 서비스의 Active Manager 구성 요소에 의해 자동으로 시작 됩니다. 보안 네트워크에서 메시지를 다시 전송하는 데 수동 작업은 필요하지 않습니다. 

## <a name="single-bit-correction"></a>단일 비트 교정 
ESE에는 하드웨어 오류를 비롯 하 여 물리적 손상을 나타내는 단일 비트 CRC 오류 (즉, 단일 비트 플립)를 감지 하 고 해결 하는 메커니즘이 포함 되어 있습니다. 이러한 오류가 발생 하면 ESE는 자동으로 해당 오류를 수정 하 고 이벤트 로그에 이벤트를 기록 합니다. 

## <a name="online-database-scanning"></a>온라인 데이터베이스 검색 
온라인 데이터베이스 검색 ( *데이터베이스 체크섬*이 라고도 함)은 ESE가 데이터베이스 일관성 검사를 사용 하 여 각 페이지를 읽고 페이지 손상을 확인 하는 프로세스입니다. 이 기본 목적은 트랜잭션 작업에서 검색 되지 않을 수 있는 물리적인 손상 및 손실 된 플러시를 검색 하는 것입니다. 데이터베이스 검색은 저장소 후 중단 작업도 수행 합니다. 크래시로 인해 공간이 누수 될 수 있으며, 온라인 데이터베이스 검색이 손실 된 공간을 찾아서 복구 합니다. 시스템은 7 일 간격으로 모든 데이터베이스를 한 번에 한 번씩 검색 하는 것으로 예상 됩니다. 

## <a name="lost-flush-detection"></a>손실 된 플러시 감지 
디스크 하위 시스템/운영 체제에서 완료로 반환 된 데이터베이스 쓰기 작업이 실제로 디스크에 쓰여지지 않았거나 잘못 된 위치에 쓰여 있으면 손실 플러시가 발생 합니다. 플러시 인시던트가 손실 될 수 있으므로 데이터베이스의 논리적인 손상으로 인해 손실 된 데이터가 손실 되는 것을 방지 하기 위해 ESE에 손실 플러시 감지 메커니즘이 포함 됩니다. 수동 복사본에 데이터베이스 페이지가 기록 됨에 따라 활성 복사본의 손실 된 플러시에 대 한 확인이 수행 됩니다. 손실 플러시가 감지 되 면 ESE는 페이지 패치 프로세스를 사용 하 여 프로세스를 복구할 수 있습니다. 

## <a name="single-page-restore"></a>단일 페이지 복원 
단일 페이지 복원 (즉, *페이지 패치*)은 손상 된 데이터베이스 페이지가 정상적인 복제본에서 정상적인 복사본으로 교체 되는 자동 프로세스입니다. 손상 된 페이지에 대 한 복구 프로세스는 데이터베이스 복사본이 활성 상태 인지 수동 지에 따라 달라 집니다. 활성 데이터베이스 복사본은 손상 된 페이지가 발견 되 면 해당 복제본 중 하나에서 페이지를 복사할 수 있는데,이 경우 해당 페이지의 복사본은 완전히 최신 상태입니다. 이 작업은 사서함 데이터베이스 복제의 기초가 되는 페이지에 대 한 요청을 로그 스트림에 배치 하는 방식으로 수행 됩니다. 복제본이 요청 된 데이터베이스 복사본에 페이지 복사본을 전송 하 여 응답 하는 페이지 요청이 발생 하는 즉시 또한 단일 페이지 복원은 현재 오프 라인 상태인 경우에도 활성 사용자가 복제본에서 페이지를 요청 하는 비동기 통신 메커니즘을 제공 합니다. 

지연 된 데이터베이스 복사본을 포함 하 여 수동 데이터베이스 복사본이 손상 되는 경우 이러한 복사본은 항상 활성 복사본의 뒤에 있기 때문에 모든 페이지를 활성 복사본에서 수동 복사본으로 복사 하는 것이 항상 안전 합니다. 수동 데이터베이스 복사본은 기본적으로 항상 사용 가능 하므로 페이지 패치 프로세스 중에 로그 재생이 일시 중단 되지만 로그 복사가 계속 됩니다. 수동 데이터베이스 복사본은 활성 복사본에서 손상 된 페이지의 복사본을 검색 하 고 필요한 최대 로그 생성 요구 사항을 충족 하는 로그 파일을 복사 및 검사 한 다음 손상 된 페이지를 패치 합니다. 페이지를 패치 한 후에는 로그 재생을 다시 시작 합니다. 지연 된 데이터베이스 복사본에 대 한 프로세스는 동일 하지만 지연 된 데이터베이스는 먼저 패치되지 상태를 달성 하는 데 필요한 모든 로그 파일을 재생 한다는 점이 다릅니다. 

## <a name="mailbox-replication-service"></a>사서함 복제 서비스 
사서함을 이동 하는 것은 대규모 전자 메일 서비스를 관리 하는 주요 부분입니다. 항상 처리할 기술 및 하드웨어 및 버전 업그레이드를 지원 하므로, 사용자에 게 사서함을 투명 하 게 이동 하는 동안 엔지니어가이 작업을 수행할 수 있도록 하는 강력 하 고 제한 된 시스템을 사용 해야 합니다 (온라인 상태 유지 가능). 전체 프로세스에서)가 핵심 이며 사서함이 커지고 더 커질 때 프로세스가 적절 하 게 확장 되도록 합니다. 

Exchange Mailbox Replication Service (MRS)는 데이터베이스 간에 사서함을 이동 하는 역할을 합니다. 이동 중에 MRS는 사서함 내의 모든 항목에 대해 일관성 확인을 수행 합니다. 일관성 문제가 발견 되 면 MRS에서 문제를 해결 하거나 손상 된 항목을 건너뛰어 사서함에서 손상이 제거 됩니다. 

MRS은 Exchange Online의 구성 요소 이므로 코드를 변경 하 여 나중에 검색 되는 새로운 유형의 손상을 해결할 수 있습니다. 예를 들어 MRS에서 수정할 수 없는 일관성 문제를 감지 하는 경우 손상을 분석 하 고 MRS 코드를 변경 하 고 불일치를 수정할 수 있습니다 (방법에 대해 이해 하 고 있는 경우). 

## <a name="log-file-checks"></a>로그 파일 검사 
Exchange 데이터베이스에서 생성 되는 모든 트랜잭션 로그 파일은 여러 유형의 일관성 검사를 수행 합니다. 로그 파일을 만들 때 가장 먼저 수행 되는 작업은 비트 패턴을 작성 한 다음 일련의 로그 쓰기를 수행 하는 것입니다. 이를 통해 Exchange Online에서 일련의 검사 (손실 플러시, CRC 및 기타 검사)를 실행 하 여 각 로그 파일이 기록 되는 즉시 확인 하 고 복제 될 때 다시 확인할 수 있습니다. 

## <a name="deployment-on-resilient-file-system"></a>회복성 있는 파일 시스템에 대 한 배포 
파일 시스템 수준에서 손상이 발생 하는 것을 방지 하기 위해 Exchange Online은 복구 기능 향상을 위해 ReFS (복원 파일 시스템) 파티션에 배포 됩니다. ReFS는 데이터 손상에 대비 하 여 데이터 가용성과 무결성을 최대화 하기 위해 향상 된 Windows Server 2012 이상 버전의 파일 시스템입니다. 특히 ReFS는 메타 데이터를 업데이트 하는 방식으로 향상 된 기능을 제공 하 여 데이터를 보다 효율적으로 보호 하 고 데이터 손상 사례를 줄여줍니다. 또한 체크섬을 사용 하 여 데이터 손상을 쉽게 찾아서 복구할 수 있도록 파일 데이터 및 메타 데이터의 무결성을 확인 합니다. 

Exchange Online은 다음과 같은 여러 가지 ReFS 이점을 활용 합니다. 
- 데이터 무결성에 대 한 탄력성을 통해 데이터 손상 인시던트가 더 적어집니다. 손상 사고가 발생 하는 횟수를 줄이는 것은 불필요 한 데이터베이스 다시 시드합니다 것을 의미 합니다. 
- 메타 데이터에 대해 실행 되는 검사 값은 더 빨리 손상 사례 검색을 가능 하 게 하 고, 데이터 볼륨에서 회색이 발생 하기 전에 고객 데이터 손상을 해결할 수 있도록 합니다.
- 성능에 영향을 주지 않고 매우 큰 데이터 집합에서 잘 작동 하도록 설계 (petabytes 및 더 크게)
- Exchange Online에서 사용 되는 다른 기능 (예: BitLocker 암호화)에 대 한 지원 

또한 Exchange Online은 다음과 같은 ReFS 기능을 활용할 수 있습니다. 
- **무결성 (무결성 스트림)** -ReFS는 일반적으로 데이터 손실이 발생할 수 있는 일반적인 오류를 방지 하는 방식으로 데이터를 저장 합니다. Office 365 검색에서는 무결성 스트림을 사용 하 여 파일 콘텐츠의 초기 디스크 손상 감지 및 체크섬 검사에 도움이 됩니다. 또한이 기능은 "조각난 쓰기" (정전로 인해 쓰기 작업이 완료 되지 않는 경우)가 발생 하는 손상 인시던트를 줄여줍니다. 
- **Availability (Salvage)** -ReFS는 데이터의 가용성을 우선적으로 사용 합니다. 이전에는 파일 시스템에서 복구를 위해 시스템을 오프 라인으로 전환 해야 하는 데이터 손상이 발생 하는 경우가 많습니다. 드문 경우 지만, ReFS는 손상 되는 경우 라이브 볼륨의 네임 스페이스에서 손상 된 데이터를 제거 하 고 복구할 수 없는 손상 된 데이터의 영향을 받지 않는 데이터를 보장 하는 기능인 salvage를 구현 합니다. 잔존 기능을 적용 하 고 데이터 손상을 Exchange Online 데이터베이스 볼륨에 격리 하는 것은 손상 및 복구 작업 시간 사이에 영향을 받지 않는 데이터베이스를 손상 된 볼륨에 유지할 수 있다는 것을 의미 합니다. 이렇게 하면 일반적으로 이러한 디스크 손상 문제로 인해 영향을 받는 데이터베이스의 가용성이 향상 됩니다. 