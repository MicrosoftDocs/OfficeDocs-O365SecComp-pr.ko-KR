---
title: 일반적인 시나리오 문제를 해결 하기 위해 Office 365 감사 로그 검색
ms.author: markjjo
author: markjjo
manager: laurawi
ms.audience: Admin
ms.topic: article
ms.service: O365-seccomp
localization_priority: Normal
ms.collection:
- Strat_O365_IP
- M365-security-compliance
search.appverid:
- MET150
- MOE150
description: Office 365 감사 로그 검색 도구를 사용 하면 손상 된 계정을 조사 하거나 사서함에 대 한 전자 메일 전달을 설정한 사람을 찾는 등의 일반적인 문제를 해결 하는 데 도움이 될 수 있습니다.
ms.openlocfilehash: bf07df7ef0767e525ca3e6ff7f5ce4c637880b80
ms.sourcegitcommit: baf23be44f1ed5abbf84f140b5ffa64fce605478
ms.translationtype: MT
ms.contentlocale: ko-KR
ms.lasthandoff: 02/26/2019
ms.locfileid: "30296771"
---
# <a name="search-the-office-365-audit-log-to-troubleshoot-common-scenarios"></a>일반적인 시나리오 문제를 해결 하기 위해 Office 365 감사 로그 검색

이 문서에서는 일반적인 지원 시나리오를 해결 하는 데 도움이 되는 Office 365 감사 로그 검색 도구를 사용 하는 방법에 대해 설명 합니다. 여기에는 다음에 대 한 감사 로그 사용이 포함 됩니다.

- 손상 된 계정에 액세스 하는 데 사용 되는 컴퓨터의 IP 주소 찾기
- 사서함에 대 한 전자 메일 전달을 설정한 사람 결정
- 사용자가 사서함에서 전자 메일 항목을 삭제 했는지 확인 합니다.
- 사용자가 받은 편지함 규칙을 만들었는지 확인

## <a name="using-the-office-365-audit-log-search-tool"></a>Office 365 감사 로그 검색 도구 사용

이 문서에서 설명 하는 각 문제 해결 시나리오는 Office 365 Security & 준수 센터에서 감사 로그 검색 도구를 사용 하는 방법에 따라 달라 집니다. 이 섹션에서는 감사 로그를 검색 하는 데 필요한 사용 권한을 나열 하 고 감사 로그 검색에 액세스 하 고 실행 하는 단계를 설명 합니다. 각 시나리오 섹션에서는 감사 로그 검색 쿼리를 구성 하는 방법과 검색 조건과 일치 하는 감사 레코드의 자세한 정보에서 찾을 항목에 대 한 구체적인 지침을 제공 합니다.

### <a name="permissions-required-to-use-the-audit-log-search-tool"></a>감사 로그 검색 도구를 사용 하는 데 필요한 사용 권한

Office 365 감사 로그를 검색 하려면 Exchange Online에서 보기 전용 감사 로그 또는 감사 로그 역할을 할당 받아야 합니다. 기본적으로 이러한 역할은 Exchange 관리 센터의 **사용 권한** 페이지에 있는 준수 관리 및 조직 관리 역할 그룹에 할당 됩니다. 자세한 내용은 [Exchange Online에서 역할 그룹 관리](https://go.microsoft.com/fwlink/p/?LinkID=730688)를 참조 하세요.

### <a name="running-audit-log-searches"></a>감사 로그 검색 실행

이 섹션에서는 감사 로그 검색을 만들고 실행 하는 기본 사항에 대해 설명 합니다. 이러한 지침을이 문서의 각 문제 해결 시나리오를 위한 시작 점으로 사용 합니다. 자세한 단계별 지침은 [Office 365 Security & 준수 센터에서 감사 로그 검색 ](search-the-audit-log-in-security-and-compliance.md#step-1-run-an-audit-log-search)을 참조 하십시오.

1. [https://protection.office.com](https://protection.office.com)으로 이동합니다.
  
2. 회사 또는 학교 계정을 사용하여 Office 365에 로그인합니다.

3. 보안 & 준수 센터의 왼쪽 창에서 **검색 & 검토** > **감사 로그 검색**을 클릭 합니다.
    
    **감사 로그 검색** 페이지가 표시 됩니다. 
    
    ![조건을 구성한 다음 검색을 클릭 하 여 검색을 실행 합니다.](media/8639d09c-2843-44e4-8b4b-9f45974ff7f1.png)
  
4. 다음 검색 조건을 구성할 수 있습니다. 이 문서에서 설명 하는 각 문제 해결 시나리오에는 이러한 필드를 구성 하기 위한 특정 지침이 권장 됩니다.
    
    a. **작업** -드롭다운 목록을 클릭 하 여 검색할 수 있는 활동을 표시 합니다. 검색을 실행 한 후에는 선택한 활동에 대 한 감사 레코드만 표시 됩니다. **모든 작업에 대해 결과 표시** 를 선택 하면 다른 검색 조건을 충족 하는 모든 작업에 대 한 결과가 표시 됩니다. 일부 문제 해결 시나리오에서는이 필드를 비워 두어야 합니다.
    
    b. **시작 날짜** 및 **종료 날짜** -해당 기간 내에 발생 한 이벤트를 표시 하려면 날짜 및 시간 범위를 선택 합니다. 지난 7 일이 기본적으로 선택 됩니다. 날짜와 시간은 utc (협정 세계시) 형식으로 표시 됩니다. 지정할 수 있는 최대 날짜 범위는 90 일입니다.

    c. **사용자** -이 상자를 클릭 하 고 검색 결과를 표시할 사용자를 한 명 이상 선택 합니다. 이 상자에서 선택한 사용자가 수행한 선택한 작업에 대 한 감사 레코드가 결과 목록에 표시 됩니다. 조직의 모든 사용자 및 서비스 계정에 대 한 항목을 반환 하려면이 상자를 비워 둡니다.
    
    d. 지정한 **** 키워드를 포함 하는 폴더의 파일에 관련 된 활동을 검색 하는 파일 또는 폴더 이름의 일부 또는 전체를 입력 합니다. 파일 또는 폴더의 URL을 지정할 수도 있습니다. url을 사용 하는 경우에는 전체 url 경로를 입력 하거나 url의 일부만 입력 해야 하며 특수 문자나 공백은 포함 하지 않습니다. 조직의 모든 파일 및 폴더에 대 한 항목을 반환 하려면이 상자를 비워 둡니다. 이 문서의 모든 문제 해결 시나리오에서는이 필드를 비워 둡니다.
    
5. 검색 **** 을 클릭 하 여 검색 조건을 사용 하 여 검색을 실행 합니다. 
    
    검색 결과가 로드 되 고 몇 분 후에 **감사 로그 검색** 페이지의 **결과** 아래에 표시 됩니다. 다음의 각 섹션에서는 특정 문제 해결 시나리오를 확인 하는 방법에 대 한 지침을 제공 합니다.

    감사 로그 검색 결과를 보거나 필터링 하거나 내보내는 방법에 대 한 자세한 내용은 다음을 참조 하십시오.

    - [검색 결과 보기](search-the-audit-log-in-security-and-compliance.md#step-2-view-the-search-results)
    - [검색 결과 필터링](search-the-audit-log-in-security-and-compliance.md#step-3-filter-the-search-results)
    - [검색 결과 내보내기](search-the-audit-log-in-security-and-compliance.md#step-4-export-the-search-results-to-a-file)

## <a name="finding-the-ip-address-of-the-computer-used-to-access-a-compromised-account"></a>손상 된 계정에 액세스 하는 데 사용 되는 컴퓨터의 IP 주소 찾기

모든 사용자가 수행한 활동에 해당 하는 IP 주소가 대부분의 감사 레코드에 포함 됩니다. 사용 된 클라이언트에 대 한 정보는 감사 레코드에도 포함 됩니다.

이 시나리오에 대 한 감사 로그 검색 쿼리를 구성 하는 방법은 다음과 같습니다.

**활동** -사례와 관련 된 경우 검색할 특정 활동을 선택 합니다. 손상 된 계정 문제를 해결 하려면 **Exchange 사서함 활동**아래에서 **사서함에 로그인 한 사용자** 를 선택 하는 것이 좋습니다. 이렇게 하면 사서함에 로그인 할 때 사용 된 IP 주소를 보여 주는 감사 레코드가 반환 됩니다. 그렇지 않은 경우에는이 필드를 비워 두어 모든 활동에 대 한 감사 레코드를 반환 합니다. 

> [!TIP]
> 이 필드를 비워 두면 누군가가 Office 365 사용자 계정에 로그인 했음을 나타내는 Azure Active Directory 활동 인 **UserLoggedIn** 활동이 반환 됩니다. 검색 결과에서 필터링을 사용 하 여 **UserLoggedIn** 감사 레코드를 표시 합니다.

**시작 날짜** 및 **종료 날짜** -조사에 적용할 수 있는 날짜 범위를 선택 합니다.

**사용자** -손상 된 계정을 조사 하는 경우에는 해당 계정을 손상 시킨 사용자를 선택 합니다. 이렇게 하면 해당 사용자 계정에 의해 수행 된 작업에 대 한 감사 레코드가 반환 됩니다.

**파일, 폴더 또는 사이트** -이 필드를 비워 둡니다.

검색을 실행 하 고 나면 각 활동의 ip 주소가 검색 결과의 **ip 주소** 열에 표시 됩니다. 검색 결과의 레코드를 클릭 하 여 플라이 아웃 페이지에서 자세한 정보를 볼 수 있습니다.

## <a name="determining-who-set-up-email-forwarding-for-a-mailbox"></a>사서함에 대 한 전자 메일 전달을 설정한 사용자 결정

사서함에 대해 전자 메일 전달이 구성 되 면 사서함으로 전송 되는 전자 메일 메시지가 다른 사서함으로 전달 됩니다. 조직 내부 또는 외부의 사용자에 게 메시지를 전달할 수 있습니다. 사서함에 전자 메일 전달이 설정 되 면 사용 되는 기본 Exchange Online cmdlet이 설정 된 **사서함**이 됩니다.

이 시나리오에 대 한 감사 로그 검색 쿼리를 구성 하는 방법은 다음과 같습니다.

**활동** -검색에서 모든 활동에 대 한 감사 레코드를 반환 하도록이 필드를 비워 둡니다. 이는 **사서함** cmdlet과 관련 된 모든 감사 레코드를 반환 하는 데 필요 합니다.

**시작 날짜** 및 **종료 날짜** -조사에 적용할 수 있는 날짜 범위를 선택 합니다.

**사용자** -특정 사용자에 대 한 전자 메일 전달 문제를 조사 하 고 있지 않은 경우이 필드를 비워 둡니다. 이렇게 하면 모든 사용자에 대해 전자 메일 전달이 설정 되었는지 쉽게 확인할 수 있습니다.

**파일, 폴더 또는 사이트** -이 필드를 비워 둡니다.

검색을 실행 한 후 검색 결과 페이지에서 **결과 필터링** 을 클릭 합니다. **활동** 열 헤더 아래의 상자에 사서함 cmdlet과 관련 된 감사 레코드만 표시 되도록 **설정 사서함** 을 입력 합니다 **** .

![감사 로그 검색 결과 필터링](media/emailforwarding1.png)

이때 각 감사 레코드의 세부 정보를 확인 하 여 활동이 전자 메일 전달과 관련이 있는지 확인 해야 합니다. 감사 레코드를 클릭 하 여 **세부 정보** 플라이 아웃 페이지를 표시 하 고 **추가 정보**를 클릭 합니다. 다음 스크린샷 및 설명은 사서함에 대해 전자 메일 전달이 설정 되었음을 나타내는 정보를 강조 표시 합니다.

![감사 레코드에서 자세한 정보](media/emailforwarding2.png)

a: **ObjectId** 필드에는 전자 메일 전달이 설정 된 사서함의 별칭이 표시 됩니다. 이 사서함은 검색 결과 페이지의 **항목** 열에도 표시 됩니다.

b. **매개 변수** 필드에서 *ForwardingSmtpAddress* 값은 전자 메일 전달이 사서함에 설정 되었음을 나타냅니다. 이 예에서는 메일이 alpinehouse.onmicrosoft.com 조직 외부에 있는 전자 메일 주소 mike@contoso.com 전달 됩니다.

c. *DeliverToMailboxAndForward* 매개 변수의 *경우 True* 값은 sarad@alpinehouse.onmicrosoft.com에 배달 된 메시지의 복사본을 ** *ForwardingSmtpAddress에서 지정한 전자 메일 주소로 전달 함을 나타냅니다. *이 예제에서는 mike@contoso.com에 해당 하는 매개 변수를 사용할 수 있습니다. *DeliverToMailboxAndForward* 매개 변수의 값이 *False*로 설정 된 경우 전자 메일은 *ForwardingSmtpAddress* 매개 변수로 지정 된 주소로만 전달 됩니다. 이는 **ObjectId** 필드에 지정 된 사서함으로 배달 되지 않습니다.

d. **UserId** 필드에는 **ObjectId** field 필드에 지정 된 사서함에 대해 전자 메일 전달을 설정한 사용자가 표시 됩니다. 이 사용자는 검색 결과 페이지의 **사용자** 열에도 표시 됩니다. 이 경우 사서함 소유자가 사서함에서 전자 메일을 전달 하는 것으로 보입니다.

사서함에 대해 전자 메일 전달이 설정 되어 있지 않은 것으로 확인 되 면 Exchange Online PowerShell에서 다음 명령을 실행 하 여 제거할 수 있습니다.

```
Set-Mailbox <mailbox alias> -ForwardingSmtpAddress $null 
```

전자 메일 전달과 관련 된 매개 변수에 대 한 자세한 내용은 [Set-Mailbox](https://docs.microsoft.com/powershell/module/exchange/mailboxes/set-mailbox) 문서를 참조 하십시오.

## <a name="determining-if-a-user-deleted-email-items"></a>사용자가 전자 메일 항목을 삭제 했는지 확인

삭제 된 전자 메일 항목에 대 한 감사 로그 레코드가 Office 365 감사 로그에 저장 되기 전에 조직의 각 사용자 사서함에 대해 사서함 감사를 사용 하도록 설정 해야 합니다. 또한 감사를 위해 소프트 삭제 및 하드 삭제 사서함 작업을 사용 하도록 설정 해야 합니다. 자세한 내용은 [Office 365에서 사서함 감사 사용](enable-mailbox-auditing.md)을 참조 하십시오. 사용자에 대해 사서함 감사가 이미 사용 하도록 설정 된 경우 다음 단계를 수행 하 여 삭제 된 전자 메일 항목에 대 한 감사 로그를 검색 합니다.

이 시나리오에 대 한 감사 로그 검색 쿼리를 구성 하는 방법은 다음과 같습니다.

**작업** - **Exchange 사서함 활동**아래에서 다음 작업 중 하나 또는 둘 다를 선택 합니다.

- **지운 편지함 폴더에서 삭제 된 메시지** -이 활동은 **소프트 삭제** 사서함 감사 작업에 해당 합니다. 이 작업은 사용자가 항목을 선택 하 고 **Shift + Delete**키를 눌러 영구적으로 삭제 한 경우에도 기록 됩니다. 항목이 영구적으로 삭제 된 후에는 삭제 된 항목 보존 기간이 만료 될 때까지 사용자가 해당 항목을 복구할 수 있습니다.

- **사서함에서** 삭제 된 메시지-이 작업은 **하드** 사서함 감사 작업에 해당 합니다. 사용자가 복구 가능한 항목 폴더에서 항목을 제거 하면이 로그를 기록 합니다. 관리자는 Office 365 Security & 준수 센터의 콘텐츠 검색 도구를 사용 하 여 삭제 된 항목 보존 기간이 만료 되거나 사용자의 사서함이 보류 중인 경우 더 오래 된 항목을 검색 하 고 복구할 수 있습니다.

**시작 날짜** 및 **종료 날짜** -조사에 적용할 수 있는 날짜 범위를 선택 합니다.

**사용자** -이 필드에서 사용자를 선택 하는 경우 감사 로그 검색 도구는 지정한 사용자가 삭제 한 전자 메일 항목에 대 한 감사 레코드 (소프트 삭제 또는 하드 삭제 됨)를 반환 합니다. 경우에 따라 전자 메일을 삭제 하는 사용자가 사서함 소유자가 아닐 수도 있습니다.

**파일, 폴더 또는 사이트** -이 필드를 비워 둡니다.

검색을 실행 한 후에는 검색 결과를 필터링 하 여 일시 삭제 된 항목에 대 한 감사 레코드를 표시 하거나 일시적으로 삭제 한 항목의 경우이를 표시할 수 있습니다. 감사 레코드를 클릭 하 여 **세부 정보** 플라이 아웃 페이지를 표시 하 고 **추가 정보**를 클릭 합니다. 제목 줄과 삭제 된 항목의 위치와 같은 삭제 된 항목에 대 한 추가 정보는 **AffectedItems** 필드에 표시 됩니다. 다음 스크린샷에서는 일시 삭제 된 항목의 **AffectedItems** 필드와 영구 삭제 된 항목의 예를 보여 줍니다.

**일시 삭제 된 항목에 대 한 AffectedItems 필드의 예**

![일시 삭제 된 항목에 대 한 감사 레코드](media/softdeleteditem.png)

**영구 삭제 된 항목에 대 한 AffectedItems 필드의 예**

![하드 삭제 된 전자 메일 항목에 대 한 감사 레코드](media/harddeleteditem.png)

### <a name="recovering-deleted-email-items"></a>삭제 된 전자 메일 항목 복구

사용자는 삭제 된 항목 보존 기간이 만료 되지 않은 경우 일시 삭제 된 항목을 복구할 수 있습니다. Exchange Online에서 삭제 된 기본 항목 보존 기간은 14 일 이지만 관리자는이 설정을 최대 30 일로 높일 수 있습니다. 삭제 된 항목을 복구 하는 방법에 대 한 지침은 사용자가 [웹 문서의 Outlook에서 지운 편지함 복구 또는 전자 메일](https://support.office.com/article/Recover-deleted-items-or-email-in-Outlook-Web-App-C3D8FC15-EEEF-4F1C-81DF-E27964B7EDD4) 을 가리킵니다.

앞에서 설명한 것 처럼, 관리자는 삭제 된 항목 보존 기간이 만료 되지 않았거나 사서함이 보류 중인 경우 보존 기간이 만료 될 때까지 항목을 보존할 수 있습니다. 콘텐츠 검색을 실행 하면 복구 가능한 항목 폴더에서 일시 삭제 되 고 영구 삭제 된 항목이 검색 쿼리와 일치 하는 경우 검색 결과에 반환 됩니다. 콘텐츠 검색을 실행 하는 방법에 대 한 자세한 내용은 [Office 365의 콘텐츠 검색](content-search.md)을 참조 하세요.

> [!TIP]
> 삭제 된 전자 메일 항목을 검색 하려면 감사 레코드의 **AffectedItems** 필드에 표시 되는 제목 줄 전체 또는 일부를 검색 합니다.

## <a name="determining-if-a-user-created-an-inbox-rule"></a>사용자가 받은 편지함 규칙을 만들었는지 확인

사용자가 자신의 Exchange Online 사서함에 대 한 받은 편지함 규칙을 만들면 해당 하는 감사 레코드가 감사 로그에 저장 됩니다. 받은 편지함 규칙에 대 한 자세한 내용은 다음 항목을 참조 하십시오.

- [웹용 Outlook에서 받은 편지함 규칙 사용](https://support.office.com/article/use-inbox-rules-in-outlook-on-the-web-8400435c-f14e-4272-9004-1548bb1848f2)
- [규칙을 사용 하 여 Outlook에서 전자 메일 메시지 관리](https://support.office.com/article/Manage-email-messages-by-using-rules-C24F5DEA-9465-4DF4-AD17-A50704D66C59)

이 시나리오에 대 한 감사 로그 검색 쿼리를 구성 하는 방법은 다음과 같습니다.

**활동** - **Exchange 사서함 활동**에서 **disable-inboxrule 만들기/수정/사용/사용 안 함 규칙**을 선택 합니다.

**시작 날짜** 및 **종료 날짜** -조사에 적용할 수 있는 날짜 범위를 선택 합니다.

**사용자** -특정 사용자를 조사 하는 경우가 아니면이 필드를 비워 둡니다. 이렇게 하면 모든 사용자가 설정한 새 받은 편지함 규칙을 식별 하는 데 도움이 됩니다.

**파일, 폴더 또는 사이트** -이 필드를 비워 둡니다.

검색을 실행 한 후에는이 작업에 대 한 감사 레코드가 검색 결과에 표시 됩니다. 감사 레코드를 클릭 하 여 **세부 정보** 플라이 아웃 페이지를 표시 하 고 **추가 정보**를 클릭 합니다. 받은 편지함 규칙 설정에 대 한 정보는 **매개 변수** 필드에 표시 됩니다. 다음 스크린샷 및 설명은 받은 편지함 규칙에 대 한 정보를 강조 표시 합니다.

![새 받은 편지함 규칙에 대 한 감사 레코드](media/NewInboxRuleRecord.png)

a: **ObjectId** 필드에 받은 편지함 규칙의 전체 이름이 표시 됩니다. 이 이름에는 사용자 사서함의 별칭 (예: SaraD)과 받은 편지함 규칙 이름 (예: "관리자 로부터 메시지 이동")이 포함 됩니다.

b. **매개 변수** 필드에 받은 편지함 규칙의 조건이 표시 됩니다. 이 예제에서는 *From* 매개 변수를 통해 조건을 지정 합니다. *From* 매개 변수에 대해 정의 된 값은 받은 편지함 규칙이 admin@alpinehouse.onmicrosoft.com에서 보내는 전자 메일을 작동 함을 나타냅니다. 받은 편지함 규칙의 조건을 정의 하는 데 사용할 수 있는 매개 변수의 전체 목록은 [disable-inboxrule](https://docs.microsoft.com/powershell/module/exchange/mailboxes/new-inboxrule) 문서를 참조 하십시오.

c. *MoveToFolder* 매개 변수는 받은 편지함 규칙에 대 한 작업을 지정 합니다. 이 예에서는 admin@alpinehouse.onmicrosoft.com에서 받은 메시지가 *adminsearch*라는 폴더로 이동 됩니다. 또한 받은 편지함 규칙의 동작을 정의 하는 데 사용할 수 있는 매개 변수의 전체 목록은 [disable-inboxrule](https://docs.microsoft.com/powershell/module/exchange/mailboxes/new-inboxrule) 문서를 참조 하십시오.

d. **UserId** 필드에는 **ObjectId** 필드에 지정 된 받은 편지함 규칙을 만든 사용자가 표시 됩니다. 이 사용자는 검색 결과 페이지의 **사용자** 열에도 표시 됩니다.